<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>House Hack Worksheet - InvestIQ</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    :root {
      --hh-primary: #059669;
      --hh-primary-dark: #047857;
      --hh-primary-light: #34d399;
      --hh-accent-bg: rgba(5, 150, 105, 0.1);
      --iq-teal: #007ea7;
      --ws-bg: #ffffff;
      --ws-bg-alt: #f8fafc;
      --ws-card: #ffffff;
      --ws-border: #e2e8f0;
      --ws-border-light: #f1f5f9;
      --ws-text-primary: #1e293b;
      --ws-text-secondary: #64748b;
      --ws-text-muted: #94a3b8;
      --ws-text-label: #475569;
      --ws-positive: #10b981;
      --ws-positive-light: rgba(16, 185, 129, 0.15);
      --ws-negative: #dc2626;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: #ffffff;
      min-height: 100vh;
      color: var(--ws-text-primary);
    }
    
    .worksheet-topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 24px;
      background: white;
      border-bottom: 1px solid var(--ws-border);
    }
    
    .worksheet-topbar-left { display: flex; align-items: center; gap: 16px; }
    
    .worksheet-back-link {
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 8px 12px;
      color: var(--ws-text-secondary);
      font-size: 14px;
      font-weight: 500;
      border-radius: 8px;
      text-decoration: none;
      transition: all 0.15s ease;
    }
    
    .worksheet-back-link:hover { background: var(--ws-bg-alt); color: var(--ws-text-primary); }
    
    .worksheet-property-info { border-left: 1px solid var(--ws-border); padding-left: 16px; }
    .worksheet-property-title { font-size: 16px; font-weight: 600; }
    .worksheet-property-subtitle { font-size: 13px; color: var(--ws-text-secondary); }
    
    .worksheet-price-badge {
      font-size: 18px;
      font-weight: 700;
      color: var(--hh-primary);
      padding: 8px 16px;
      background: var(--hh-accent-bg);
      border-radius: 8px;
      border: 1px solid var(--hh-primary-light);
    }
    
    .worksheet-tab-nav {
      display: flex;
      align-items: center;
      background: white;
      border-bottom: 2px solid var(--ws-border);
      padding: 0 24px;
    }
    
    .worksheet-tabs-scroll { display: flex; gap: 4px; overflow-x: auto; flex: 1; }
    
    .worksheet-tab {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 14px 16px;
      font-size: 13px;
      font-weight: 500;
      color: var(--ws-text-secondary);
      background: transparent;
      border: none;
      border-bottom: 2px solid transparent;
      margin-bottom: -2px;
      cursor: pointer;
      white-space: nowrap;
    }
    
    .worksheet-tab:hover { color: var(--ws-text-primary); background: var(--ws-bg-alt); }
    .worksheet-tab.active { color: var(--hh-primary); border-bottom-color: var(--hh-primary); background: var(--hh-accent-bg); }
    .worksheet-tab.disabled { opacity: 0.5; cursor: not-allowed; }
    .tab-badge { font-size: 10px; padding: 2px 6px; background: var(--ws-border); color: var(--ws-text-muted); border-radius: 4px; text-transform: uppercase; }
    
    .strategy-dropdown { position: relative; }
    
    .strategy-dropdown-trigger {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 14px;
      background: linear-gradient(135deg, var(--hh-primary) 0%, var(--hh-primary-dark) 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
    }
    
    .strategy-dropdown-trigger:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(5, 150, 105, 0.3); }
    
    .strategy-dropdown-menu {
      position: absolute;
      top: calc(100% + 8px);
      left: 0;
      min-width: 280px;
      background: white;
      border: 1px solid var(--ws-border);
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
      z-index: 100;
      display: none;
      overflow: hidden;
    }
    
    .strategy-dropdown.open .strategy-dropdown-menu { display: block; }
    
    .strategy-dropdown-header {
      padding: 12px 16px;
      font-size: 11px;
      font-weight: 600;
      color: var(--ws-text-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      border-bottom: 1px solid var(--ws-border-light);
      background: var(--ws-bg-alt);
    }
    
    .strategy-option {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      width: 100%;
      border: none;
      background: transparent;
      cursor: pointer;
      text-align: left;
    }
    
    .strategy-option:hover { background: var(--ws-bg-alt); }
    .strategy-option.active { background: var(--hh-accent-bg); }
    
    .strategy-option-icon {
      width: 36px;
      height: 36px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .strategy-option-icon.ltr { background: rgba(0, 126, 167, 0.15); color: #007ea7; }
    .strategy-option-icon.brrrr { background: rgba(124, 58, 237, 0.15); color: #7c3aed; }
    .strategy-option-icon.flip { background: rgba(217, 119, 6, 0.15); color: #d97706; }
    .strategy-option-icon.wholesale { background: rgba(37, 99, 235, 0.15); color: #2563eb; }
    .strategy-option-icon.str { background: rgba(249, 115, 22, 0.15); color: #f97316; }
    .strategy-option-icon.househack { background: rgba(5, 150, 105, 0.15); color: #059669; }
    
    .strategy-option-content { flex: 1; }
    .strategy-option-name { font-size: 14px; font-weight: 600; color: var(--ws-text-primary); }
    .strategy-option-desc { font-size: 12px; color: var(--ws-text-muted); }
    .strategy-option-check { width: 20px; height: 20px; color: var(--hh-primary); opacity: 0; }
    .strategy-option.active .strategy-option-check { opacity: 1; }
    
    .summary-cards-wrapper {
      position: sticky;
      top: 0;
      z-index: 20;
      background: white;
      border-bottom: 1px solid var(--ws-border);
      padding: 16px 24px;
    }
    
    .summary-cards {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: clamp(6px, 1vw, 12px);
      max-width: 1600px;
      margin: 0 auto;
    }
    
    .summary-card {
      background: white;
      border: 1px solid var(--ws-border);
      border-radius: clamp(8px, 1vw, 12px);
      padding: clamp(8px, 1.5vw, 16px) clamp(8px, 1.5vw, 20px);
      box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
    }
    
    .summary-card.highlight {
      background: linear-gradient(135deg, var(--hh-accent-bg) 0%, white 100%);
      border: 2px solid var(--hh-primary);
    }
    
    .summary-card-label { font-size: clamp(9px, 1vw, 11px); font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; color: var(--ws-text-muted); margin-bottom: clamp(4px, 0.6vw, 8px); }
    .summary-card-value { font-size: clamp(16px, 2.2vw, 28px); font-weight: 700; color: var(--ws-text-primary); line-height: 1.2; }
    .summary-card-value.positive { color: var(--ws-positive); }
    .summary-card-value.negative { color: var(--ws-negative); }
    .summary-card-value.accent { color: var(--hh-primary); }
    .summary-card-subtitle { font-size: clamp(9px, 0.9vw, 11px); color: var(--ws-text-muted); margin-top: clamp(2px, 0.3vw, 4px); }
    
    .worksheet-main-area {
      display: grid;
      grid-template-columns: 200px 1fr 320px;
      gap: 24px;
      padding: 24px;
      max-width: 1600px;
      margin: 0 auto;
    }
    
    .worksheet-help-panel { display: flex; flex-direction: column; gap: 16px; }
    .worksheet-help-header { display: flex; align-items: center; gap: 8px; font-size: 13px; font-weight: 600; color: var(--hh-primary); padding-bottom: 12px; border-bottom: 1px solid var(--ws-border-light); }
    .worksheet-help-tips { list-style: none; }
    .worksheet-help-tips li { display: flex; align-items: flex-start; gap: 8px; font-size: 12px; color: var(--ws-text-secondary); padding: 10px 0; border-bottom: 1px solid var(--ws-border-light); line-height: 1.5; }
    .worksheet-help-tips li svg { flex-shrink: 0; margin-top: 2px; color: var(--hh-primary); }
    
    .worksheet-content-area { display: flex; flex-direction: column; gap: 20px; }
    
    .section-card { background: white; border: 1px solid var(--ws-border); border-radius: 12px; overflow: hidden; box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1); }
    .section-header { display: flex; align-items: center; justify-content: space-between; padding: 14px 20px; background: linear-gradient(135deg, rgba(5, 150, 105, 0.08) 0%, white 100%); border-bottom: 1px solid var(--ws-border-light); cursor: pointer; }
    .section-header:hover { background: linear-gradient(135deg, rgba(5, 150, 105, 0.12) 0%, white 100%); }
    .section-title { font-size: 13px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; color: var(--hh-primary-dark); }
    .section-badge { font-size: 11px; font-weight: 600; padding: 4px 10px; background: var(--hh-primary); color: white; border-radius: 6px; }
    .section-content { padding: 16px 20px; }
    
    .data-row { display: grid; grid-template-columns: 140px 1fr auto; gap: 16px; padding: 12px 0; border-bottom: 1px solid var(--ws-border-light); align-items: center; }
    .data-row:last-child { border-bottom: none; }
    .data-row.total { background: linear-gradient(90deg, rgba(5, 150, 105, 0.08) 0%, transparent 100%); margin: 0 -20px; padding: 14px 20px; border-bottom: none; margin-top: 8px; }
    .data-row.total .data-label span { font-weight: 700; color: var(--hh-primary-dark); }
    .data-row.calculated { background: var(--ws-bg-alt); margin: 0 -20px; padding: 10px 20px; }
    .data-row.highlight-row { background: linear-gradient(90deg, rgba(5, 150, 105, 0.15) 0%, rgba(5, 150, 105, 0.05) 100%); margin: 0 -20px; padding: 12px 20px; }
    
    .data-label { display: flex; align-items: center; gap: 8px; }
    .data-label span { font-size: 13px; color: var(--ws-text-label); font-weight: 500; }
    .data-label svg { color: var(--ws-text-muted); }
    
    .slider-container { display: flex; align-items: center; gap: 12px; }
    .slider-wrapper { flex: 1; position: relative; }
    
    .slider-input {
      width: 100%;
      height: 6px;
      border-radius: 3px;
      background: #e2e8f0;
      outline: none;
      -webkit-appearance: none;
      cursor: pointer;
    }
    
    .slider-input::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: white;
      border: 3px solid var(--hh-primary);
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
    }
    
    .slider-input::-webkit-slider-thumb:hover { transform: scale(1.15); }
    
    .slider-value {
      min-width: 90px;
      padding: 8px 12px;
      border: 1px solid var(--ws-border);
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      color: var(--ws-text-primary);
      text-align: right;
      background: white;
    }
    
    .slider-value:focus { outline: none; border-color: var(--hh-primary); box-shadow: 0 0 0 3px rgba(5, 150, 105, 0.15); }
    .slider-secondary { font-size: 11px; color: var(--ws-text-muted); text-align: right; min-width: 70px; }
    
    .select-input {
      padding: 8px 12px;
      border: 1px solid var(--ws-border);
      border-radius: 8px;
      font-size: 13px;
      color: var(--ws-text-primary);
      background: white;
      cursor: pointer;
      min-width: 160px;
    }
    
    .select-input:focus { outline: none; border-color: var(--hh-primary); }
    
    .worksheet-charts-sidebar { display: flex; flex-direction: column; gap: 16px; position: sticky; top: 120px; height: fit-content; }
    .chart-card { background: white; border: 1px solid var(--ws-border); border-radius: 12px; padding: 16px; box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1); }
    .chart-card-title { font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; color: var(--hh-primary-dark); margin-bottom: 16px; padding-bottom: 8px; border-bottom: 1px solid var(--ws-border-light); }
    
    .pricing-ladder { position: relative; padding: 16px 0; }
    .pricing-ladder-track { position: absolute; left: 50%; top: 20px; bottom: 20px; width: 4px; background: linear-gradient(180deg, #dc2626 0%, #f97316 25%, #eab308 50%, #10b981 75%, var(--hh-primary) 100%); border-radius: 2px; transform: translateX(-50%); }
    .pricing-ladder-item { display: flex; align-items: center; padding: 8px 0; position: relative; }
    .pricing-ladder-item.highlight { background: var(--hh-accent-bg); margin: 0 -16px; padding: 8px 16px; border-radius: 8px; }
    .pricing-ladder-label { flex: 1; text-align: right; padding-right: 20px; font-size: 11px; color: var(--ws-text-muted); }
    .pricing-ladder-marker { width: 16px; height: 16px; border-radius: 50%; background: white; border: 3px solid var(--ws-border); z-index: 1; flex-shrink: 0; }
    .pricing-ladder-marker.list { border-color: #dc2626; }
    .pricing-ladder-marker.current { border-color: var(--hh-primary); background: var(--hh-primary); }
    .pricing-ladder-marker.target { border-color: #eab308; background: #eab308; }
    .pricing-ladder-marker.coc { border-color: #10b981; }
    .pricing-ladder-marker.mao { border-color: var(--iq-teal); }
    .pricing-ladder-value { flex: 1; padding-left: 20px; font-size: 14px; font-weight: 600; color: var(--ws-text-primary); }
    .pricing-ladder-value.current { color: var(--hh-primary); }
    .pricing-ladder-value.list { color: #dc2626; }
    .pricing-ladder-hint { display: block; font-size: 10px; font-weight: 500; color: var(--ws-text-muted); }
    
    .housing-cost-gauge { text-align: center; padding: 20px 0; }
    .housing-cost-value { font-size: 36px; font-weight: 700; }
    .housing-cost-value.positive { color: var(--hh-primary); }
    .housing-cost-value.negative { color: var(--ws-negative); }
    .housing-cost-label { font-size: 12px; color: var(--ws-text-muted); margin-top: 4px; }
    
    .unit-breakdown { display: flex; flex-direction: column; gap: 8px; }
    .unit-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 12px; background: var(--ws-bg-alt); border-radius: 8px; }
    .unit-item.owner { background: var(--hh-accent-bg); border: 1px solid var(--hh-primary-light); }
    .unit-item-label { font-size: 12px; color: var(--ws-text-secondary); }
    .unit-item-value { font-size: 14px; font-weight: 600; }
    
    .comparison-bar { margin-bottom: 12px; }
    .comparison-bar-label { display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 4px; }
    .comparison-bar-track { height: 8px; background: #e2e8f0; border-radius: 4px; overflow: hidden; }
    .comparison-bar-fill { height: 100%; border-radius: 4px; }
    
    @media (max-width: 1200px) {
      .worksheet-main-area { grid-template-columns: 1fr 300px; }
      .worksheet-help-panel { display: none; }
      .summary-cards { grid-template-columns: repeat(3, 1fr); }
    }
    
    @media (max-width: 900px) {
      .worksheet-main-area { grid-template-columns: 1fr; }
      .worksheet-charts-sidebar { position: static; }
      .summary-cards { grid-template-columns: repeat(2, 1fr); }
    }
  </style>
</head>
<body>
  <header class="worksheet-topbar">
    <div class="worksheet-topbar-left">
      <a href="#" class="worksheet-back-link">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
        Back
      </a>
      <div class="worksheet-property-info">
        <div class="worksheet-property-title" id="property-title">742 Maple Street - Duplex</div>
        <div class="worksheet-property-subtitle" id="property-subtitle">Denver, CO 80220 • 4 BR • 2 BA • 2,400 Sq.Ft. • 2 Units</div>
      </div>
    </div>
    <div class="worksheet-price-badge" id="property-price-badge">$425,000</div>
  </header>
  
  <nav class="worksheet-tab-nav">
    <div class="worksheet-tabs-scroll">
      <div class="strategy-dropdown" id="strategy-dropdown">
        <button class="strategy-dropdown-trigger">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
          <span id="current-strategy-name">House Hack</span>
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>
        </button>
        
        <div class="strategy-dropdown-menu">
          <div class="strategy-dropdown-header">Select Strategy</div>
          
          <button class="strategy-option" data-strategy="ltr" onclick="selectStrategy('ltr', 'LTR Worksheet', 'worksheet-preview.html')">
            <div class="strategy-option-icon ltr"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg></div>
            <div class="strategy-option-content">
              <div class="strategy-option-name">LTR (Long-Term Rental)</div>
              <div class="strategy-option-desc">Buy & hold for monthly cash flow</div>
            </div>
            <svg class="strategy-option-check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
          </button>
          
          <button class="strategy-option" data-strategy="brrrr" onclick="selectStrategy('brrrr', 'BRRRR Worksheet', 'worksheet-brrrr.html')">
            <div class="strategy-option-icon brrrr"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"/></svg></div>
            <div class="strategy-option-content">
              <div class="strategy-option-name">BRRRR</div>
              <div class="strategy-option-desc">Buy, Rehab, Rent, Refinance, Repeat</div>
            </div>
            <svg class="strategy-option-check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
          </button>
          
          <button class="strategy-option" data-strategy="flip" onclick="selectStrategy('flip', 'Fix & Flip', 'worksheet-flip.html')">
            <div class="strategy-option-icon flip"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg></div>
            <div class="strategy-option-content">
              <div class="strategy-option-name">Fix & Flip</div>
              <div class="strategy-option-desc">Buy, renovate, sell for profit</div>
            </div>
            <svg class="strategy-option-check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
          </button>
          
          <button class="strategy-option" data-strategy="wholesale" onclick="selectStrategy('wholesale', 'Wholesale', 'worksheet-wholesale.html')">
            <div class="strategy-option-icon wholesale"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 3h5v5"/><path d="M8 21H3v-5"/><path d="M21 3l-9 9"/><path d="M3 21l9-9"/></svg></div>
            <div class="strategy-option-content">
              <div class="strategy-option-name">Wholesale</div>
              <div class="strategy-option-desc">Assign contracts for quick profit</div>
            </div>
            <svg class="strategy-option-check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
          </button>
          
          <button class="strategy-option" data-strategy="str" onclick="selectStrategy('str', 'STR Worksheet', 'worksheet-str.html')">
            <div class="strategy-option-icon str"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg></div>
            <div class="strategy-option-content">
              <div class="strategy-option-name">Short-Term Rental</div>
              <div class="strategy-option-desc">Vacation rentals & Airbnb</div>
            </div>
            <svg class="strategy-option-check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
          </button>
          
          <button class="strategy-option active" data-strategy="househack" onclick="selectStrategy('househack', 'House Hack', 'worksheet-househack.html')">
            <div class="strategy-option-icon househack"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg></div>
            <div class="strategy-option-content">
              <div class="strategy-option-name">House Hack</div>
              <div class="strategy-option-desc">Live in one unit, rent the others</div>
            </div>
            <svg class="strategy-option-check" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>
          </button>
        </div>
      </div>
      
      <button class="worksheet-tab">Projections</button>
      <button class="worksheet-tab disabled">Comps <span class="tab-badge">Soon</span></button>
      <button class="worksheet-tab disabled">FHA Calc <span class="tab-badge">Soon</span></button>
      <button class="worksheet-tab disabled">Move-Out <span class="tab-badge">Soon</span></button>
    </div>
  </nav>
  
  <div class="summary-cards-wrapper">
    <div class="summary-cards">
      <div class="summary-card highlight">
        <div class="summary-card-label">Your Housing Cost</div>
        <div class="summary-card-value accent" id="summary-housing-cost">$485</div>
        <div class="summary-card-subtitle">Per month</div>
      </div>
      <div class="summary-card">
        <div class="summary-card-label">Rental Income</div>
        <div class="summary-card-value positive" id="summary-rental-income">$1,800</div>
      </div>
      <div class="summary-card">
        <div class="summary-card-label">Cash Needed</div>
        <div class="summary-card-value" id="summary-cash-needed">$29,875</div>
      </div>
      <div class="summary-card">
        <div class="summary-card-label">If You Move Out</div>
        <div class="summary-card-value positive" id="summary-move-out">$615/mo</div>
      </div>
      <div class="summary-card">
        <div class="summary-card-label">CoC Return</div>
        <div class="summary-card-value positive" id="summary-coc">24.7%</div>
      </div>
      <div class="summary-card" style="background: linear-gradient(135deg, var(--hh-accent-bg) 0%, white 100%);">
        <div class="summary-card-label">Deal Score</div>
        <div class="summary-card-value accent" id="summary-deal-score">91</div>
        <div class="summary-card-subtitle" id="score-label">Excellent</div>
      </div>
    </div>
  </div>
  
  <div class="worksheet-main-area">
    <aside class="worksheet-help-panel">
      <div class="worksheet-help-header">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
        House Hack Tips
      </div>
      <ul class="worksheet-help-tips">
        <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>FHA loans allow 3.5% down on 2-4 unit properties</li>
        <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>75% of rental income can count toward qualifying</li>
        <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>Must live in property for 1 year minimum</li>
        <li><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>Great way to start building rental portfolio</li>
      </ul>
    </aside>
    
    <main class="worksheet-content-area">
      <div class="section-card">
        <div class="section-header">
          <span class="section-title">Property & Purchase</span>
          <span class="section-badge">Owner-Occupied</span>
        </div>
        <div class="section-content">
          <div class="data-row">
            <div class="data-label"><span>Property Type</span></div>
            <div></div>
            <select class="select-input" id="property-type">
              <option value="2">Duplex (2 Units)</option>
              <option value="3">Triplex (3 Units)</option>
              <option value="4">Fourplex (4 Units)</option>
              <option value="1">SFH with ADU</option>
              <option value="rooms">Room Rental</option>
            </select>
          </div>
          
          <div class="data-row has-slider">
            <div class="data-label"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg><span>Purchase Price</span></div>
            <div class="slider-container"><div class="slider-wrapper"><input type="range" class="slider-input" min="150000" max="800000" value="425000"></div></div>
            <input type="text" class="slider-value" value="$425,000">
          </div>
          
          <div class="data-row has-slider">
            <div class="data-label"><span>$ Down Payment</span></div>
            <div class="slider-container"><div class="slider-wrapper"><input type="range" class="slider-input" min="3.5" max="25" step="0.5" value="5"></div></div>
            <div style="display: flex; gap: 8px; align-items: center;">
              <input type="text" class="slider-value" value="5%" style="min-width: 60px;">
              <span class="slider-secondary" id="down-payment-amt">$21,250</span>
            </div>
          </div>
          
          <div class="data-row has-slider">
            <div class="data-label"><span>Closing Costs</span></div>
            <div class="slider-container"><div class="slider-wrapper"><input type="range" class="slider-input" min="0" max="25000" value="8625"></div></div>
            <input type="text" class="slider-value" value="$8,625">
          </div>
          
          <div class="data-row total">
            <div class="data-label"><span>Total Cash Needed</span></div>
            <div></div>
            <div style="font-weight: 700; font-size: 16px; color: var(--hh-primary);" id="calc-total-cash">$29,875</div>
          </div>
        </div>
      </div>
      
      <div class="section-card">
        <div class="section-header">
          <span class="section-title">Financing</span>
          <span class="section-badge">FHA Eligible</span>
        </div>
        <div class="section-content">
          <div class="data-row calculated">
            <div class="data-label"><span>Loan Amount</span></div>
            <div></div>
            <div style="font-weight: 600;" id="calc-loan-amount">$403,750</div>
          </div>
          
          <div class="data-row">
            <div class="data-label"><span>Loan Type</span></div>
            <div></div>
            <select class="select-input" id="loan-type">
              <option value="fha">FHA (3.5% min)</option>
              <option value="conventional" selected>Conventional (5% min)</option>
              <option value="va">VA (0% down)</option>
            </select>
          </div>
          
          <div class="data-row has-slider">
            <div class="data-label"><span>Interest Rate</span></div>
            <div class="slider-container"><div class="slider-wrapper"><input type="range" class="slider-input" min="4" max="10" step="0.125" value="7.25"></div></div>
            <input type="text" class="slider-value" value="7.25%">
          </div>
          
          <div class="data-row has-slider">
            <div class="data-label"><span>Loan Term</span></div>
            <div class="slider-container"><div class="slider-wrapper"><input type="range" class="slider-input" min="15" max="30" step="5" value="30"></div></div>
            <input type="text" class="slider-value" value="30 years">
          </div>
          
          <div class="data-row has-slider">
            <div class="data-label"><span>PMI Rate</span></div>
            <div class="slider-container"><div class="slider-wrapper"><input type="range" class="slider-input" min="0" max="1.5" step="0.1" value="0.8"></div></div>
            <div style="display: flex; gap: 8px; align-items: center;">
              <input type="text" class="slider-value" value="0.8%" style="min-width: 60px;">
              <span class="slider-secondary" id="pmi-amt">$269/mo</span>
            </div>
          </div>
          
          <div class="data-row total">
            <div class="data-label"><span>Total Monthly Payment</span></div>
            <div></div>
            <div style="font-weight: 700; font-size: 16px;" id="calc-monthly-payment">$3,023</div>
          </div>
        </div>
      </div>
      
      <div class="section-card">
        <div class="section-header">
          <span class="section-title">Rental Income</span>
        </div>
        <div class="section-content">
          <div class="data-row highlight-row">
            <div class="data-label"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg><span>Your Unit (Owner)</span></div>
            <div></div>
            <div style="font-weight: 600; color: var(--hh-primary);">You Live Here</div>
          </div>
          
          <div class="data-row has-slider">
            <div class="data-label"><span>Unit 2 Rent</span></div>
            <div class="slider-container"><div class="slider-wrapper"><input type="range" class="slider-input" min="500" max="3500" value="1800"></div></div>
            <input type="text" class="slider-value" value="$1,800">
          </div>
          
          <div class="data-row has-slider" id="unit3-row" style="display: none;">
            <div class="data-label"><span>Unit 3 Rent</span></div>
            <div class="slider-container"><div class="slider-wrapper"><input type="range" class="slider-input" min="500" max="3500" value="1600"></div></div>
            <input type="text" class="slider-value" value="$1,600">
          </div>
          
          <div class="data-row has-slider" id="unit4-row" style="display: none;">
            <div class="data-label"><span>Unit 4 Rent</span></div>
            <div class="slider-container"><div class="slider-wrapper"><input type="range" class="slider-input" min="500" max="3500" value="1500"></div></div>
            <input type="text" class="slider-value" value="$1,500">
          </div>
          
          <div class="data-row has-slider">
            <div class="data-label"><span>Vacancy Rate</span></div>
            <div class="slider-container"><div class="slider-wrapper"><input type="range" class="slider-input" min="0" max="15" value="5"></div></div>
            <input type="text" class="slider-value" value="5%">
          </div>
          
          <div class="data-row total">
            <div class="data-label"><span>Effective Rental Income</span></div>
            <div></div>
            <div style="font-weight: 700; font-size: 16px; color: var(--ws-positive);" id="calc-rental-income">$1,710/mo</div>
          </div>
        </div>
      </div>
      
      <div class="section-card">
        <div class="section-header">
          <span class="section-title">Operating Expenses</span>
        </div>
        <div class="section-content">
          <div class="data-row has-slider">
            <div class="data-label"><span>Property Taxes</span></div>
            <div class="slider-container"><div class="slider-wrapper"><input type="range" class="slider-input" min="100" max="1000" value="354"></div></div>
            <input type="text" class="slider-value" value="$354/mo">
          </div>
          
          <div class="data-row has-slider">
            <div class="data-label"><span>Insurance</span></div>
            <div class="slider-container"><div class="slider-wrapper"><input type="range" class="slider-input" min="50" max="400" value="175"></div></div>
            <input type="text" class="slider-value" value="$175/mo">
          </div>
          
          <div class="data-row has-slider">
            <div class="data-label"><span>Maintenance</span></div>
            <div class="slider-container"><div class="slider-wrapper"><input type="range" class="slider-input" min="1" max="10" value="5"></div></div>
            <div style="display: flex; gap: 8px; align-items: center;">
              <input type="text" class="slider-value" value="5%" style="min-width: 60px;">
              <span class="slider-secondary" id="maintenance-amt">$86/mo</span>
            </div>
          </div>
          
          <div class="data-row has-slider">
            <div class="data-label"><span>CapEx Reserve</span></div>
            <div class="slider-container"><div class="slider-wrapper"><input type="range" class="slider-input" min="1" max="10" value="5"></div></div>
            <div style="display: flex; gap: 8px; align-items: center;">
              <input type="text" class="slider-value" value="5%" style="min-width: 60px;">
              <span class="slider-secondary" id="capex-amt">$86/mo</span>
            </div>
          </div>
          
          <div class="data-row has-slider">
            <div class="data-label"><span>Utilities (Your Share)</span></div>
            <div class="slider-container"><div class="slider-wrapper"><input type="range" class="slider-input" min="0" max="400" value="150"></div></div>
            <input type="text" class="slider-value" value="$150/mo">
          </div>
          
          <div class="data-row total">
            <div class="data-label"><span>Total Monthly Expenses</span></div>
            <div></div>
            <div style="font-weight: 700; font-size: 16px; color: var(--ws-negative);" id="calc-total-expenses">-$1,001/mo</div>
          </div>
        </div>
      </div>
      
      <div class="section-card">
        <div class="section-header">
          <span class="section-title">Your Housing Cost</span>
        </div>
        <div class="section-content">
          <div class="data-row calculated">
            <div class="data-label"><span>Mortgage + PMI</span></div>
            <div></div>
            <div style="font-weight: 600;" id="cf-mortgage">$3,023</div>
          </div>
          
          <div class="data-row calculated">
            <div class="data-label"><span>Operating Expenses</span></div>
            <div></div>
            <div style="font-weight: 600;" id="cf-opex">$1,001</div>
          </div>
          
          <div class="data-row calculated">
            <div class="data-label"><span>Rental Income Offset</span></div>
            <div></div>
            <div style="font-weight: 600; color: var(--ws-positive);" id="cf-income">-$1,710</div>
          </div>
          
          <div class="data-row total">
            <div class="data-label"><span>Your Net Housing Cost</span></div>
            <div></div>
            <div style="font-weight: 700; font-size: 20px;" id="cf-housing-cost">$2,314</div>
          </div>
          
          <div class="data-row" style="border-top: 2px dashed var(--ws-border); padding-top: 16px; margin-top: 8px;">
            <div class="data-label"><span>Market Rent Equivalent</span></div>
            <div></div>
            <div style="font-weight: 600; color: var(--ws-text-muted);" id="cf-market-rent">$2,200</div>
          </div>
          
          <div class="data-row highlight-row">
            <div class="data-label"><span>Monthly Savings vs Renting</span></div>
            <div></div>
            <div style="font-weight: 700; font-size: 18px; color: var(--ws-positive);" id="cf-savings">-$114</div>
          </div>
        </div>
      </div>
    </main>
    
    <aside class="worksheet-charts-sidebar">
      <div class="chart-card">
        <div class="chart-card-title">Pricing Ladder</div>
        <div class="pricing-ladder">
          <div class="pricing-ladder-track"></div>
          <div class="pricing-ladder-item">
            <div class="pricing-ladder-label">List Price</div>
            <div class="pricing-ladder-marker list"></div>
            <div class="pricing-ladder-value list" id="ladder-list">$449,000</div>
          </div>
          <div class="pricing-ladder-item highlight">
            <div class="pricing-ladder-label">Your Offer</div>
            <div class="pricing-ladder-marker current"></div>
            <div class="pricing-ladder-value current" id="ladder-offer">$425,000</div>
          </div>
          <div class="pricing-ladder-item">
            <div class="pricing-ladder-label">Breakeven</div>
            <div class="pricing-ladder-marker target"></div>
            <div class="pricing-ladder-value" id="ladder-breakeven">$480,000<span class="pricing-ladder-hint">$0 housing cost</span></div>
          </div>
          <div class="pricing-ladder-item">
            <div class="pricing-ladder-label">10% CoC</div>
            <div class="pricing-ladder-marker coc"></div>
            <div class="pricing-ladder-value" id="ladder-10coc">$395,000<span class="pricing-ladder-hint">After move-out</span></div>
          </div>
          <div class="pricing-ladder-item">
            <div class="pricing-ladder-label">FHA Max</div>
            <div class="pricing-ladder-marker mao"></div>
            <div class="pricing-ladder-value" id="ladder-fha">$472,030<span class="pricing-ladder-hint">Your area</span></div>
          </div>
        </div>
      </div>
      
      <div class="chart-card">
        <div class="chart-card-title">Your Housing Cost</div>
        <div class="housing-cost-gauge">
          <div class="housing-cost-value" id="gauge-housing-cost">$485</div>
          <div class="housing-cost-label">Per month to live here</div>
        </div>
        <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--ws-border-light);">
          <div class="comparison-bar">
            <div class="comparison-bar-label">
              <span style="color: var(--ws-text-secondary);">House Hack</span>
              <span style="font-weight: 600; color: var(--hh-primary);" id="bar-househack">$485</span>
            </div>
            <div class="comparison-bar-track">
              <div class="comparison-bar-fill" id="bar-househack-fill" style="width: 22%; background: linear-gradient(90deg, var(--hh-primary), var(--hh-primary-light));"></div>
            </div>
          </div>
          <div class="comparison-bar">
            <div class="comparison-bar-label">
              <span style="color: var(--ws-text-secondary);">Renting Equivalent</span>
              <span style="font-weight: 600;" id="bar-renting">$2,200</span>
            </div>
            <div class="comparison-bar-track">
              <div class="comparison-bar-fill" style="width: 100%; background: linear-gradient(90deg, #94a3b8, #cbd5e1);"></div>
            </div>
          </div>
          <div style="text-align: center; margin-top: 12px; padding: 12px; background: var(--hh-accent-bg); border-radius: 8px;">
            <div style="font-size: 11px; color: var(--ws-text-muted);">You Save</div>
            <div style="font-size: 24px; font-weight: 700; color: var(--hh-primary);" id="gauge-savings">$1,715/mo</div>
          </div>
        </div>
      </div>
      
      <div class="chart-card">
        <div class="chart-card-title">Unit Breakdown</div>
        <div class="unit-breakdown">
          <div class="unit-item owner">
            <span class="unit-item-label">Unit 1 (You)</span>
            <span class="unit-item-value" style="color: var(--hh-primary);">Owner-Occupied</span>
          </div>
          <div class="unit-item">
            <span class="unit-item-label">Unit 2</span>
            <span class="unit-item-value" id="unit2-display">$1,800/mo</span>
          </div>
          <div class="unit-item" id="unit3-display-row" style="display: none;">
            <span class="unit-item-label">Unit 3</span>
            <span class="unit-item-value" id="unit3-display">$1,600/mo</span>
          </div>
          <div class="unit-item" id="unit4-display-row" style="display: none;">
            <span class="unit-item-label">Unit 4</span>
            <span class="unit-item-value" id="unit4-display">$1,500/mo</span>
          </div>
        </div>
      </div>
      
      <div class="chart-card">
        <div class="chart-card-title">If You Move Out</div>
        <div style="text-align: center; padding: 16px 0;">
          <div style="font-size: 12px; color: var(--ws-text-muted); margin-bottom: 8px;">Property becomes full rental</div>
          <div style="font-size: 32px; font-weight: 700; color: var(--ws-positive);" id="moveout-cashflow">$615</div>
          <div style="font-size: 12px; color: var(--ws-text-muted);">Monthly Cash Flow</div>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--ws-border-light);">
          <div style="text-align: center; padding: 10px; background: var(--ws-bg-alt); border-radius: 8px;">
            <div style="font-size: 10px; color: var(--ws-text-muted);">CAP RATE</div>
            <div style="font-size: 16px; font-weight: 700;" id="moveout-cap">7.2%</div>
          </div>
          <div style="text-align: center; padding: 10px; background: var(--ws-bg-alt); border-radius: 8px;">
            <div style="font-size: 10px; color: var(--ws-text-muted);">COC RETURN</div>
            <div style="font-size: 16px; font-weight: 700; color: var(--ws-positive);" id="moveout-coc">24.7%</div>
          </div>
        </div>
      </div>
    </aside>
  </div>
  
  <script>
    function formatCurrency(value) { return '$' + Math.round(value).toLocaleString('en-US'); }
    function parseCurrency(str) { if (typeof str === 'number') return str; return parseFloat(str.replace(/[$,%]/g, '').replace(/,/g, '')) || 0; }
    function updateElement(id, value) { const el = document.getElementById(id); if (el) el.textContent = value; }
    
    document.querySelectorAll('.slider-input').forEach(slider => {
      function updateProgress() {
        const min = parseFloat(slider.min);
        const max = parseFloat(slider.max);
        const value = parseFloat(slider.value);
        const progress = ((value - min) / (max - min)) * 100;
        slider.style.background = `linear-gradient(to right, #059669 0%, #059669 ${progress}%, #e2e8f0 ${progress}%, #e2e8f0 100%)`;
      }
      updateProgress();
      slider.addEventListener('input', function() { updateProgress(); recalculateAll(); });
    });
    
    document.querySelectorAll('.data-row.has-slider').forEach(row => {
      const slider = row.querySelector('.slider-input');
      const input = row.querySelector('.slider-value');
      if (slider && input) {
        slider.addEventListener('input', function() {
          const value = parseFloat(this.value);
          const label = row.querySelector('.data-label span')?.textContent || '';
          if (label.includes('Rate') || label.includes('Down') || label.includes('Vacancy') || label.includes('Maintenance') || label.includes('CapEx') || label.includes('PMI')) {
            input.value = value.toFixed(1) + '%';
          } else if (label.includes('Term')) {
            input.value = value + ' years';
          } else if (label.includes('/mo') || label.includes('Taxes') || label.includes('Insurance') || label.includes('Utilities')) {
            input.value = formatCurrency(value) + '/mo';
          } else {
            input.value = formatCurrency(value);
          }
        });
        input.addEventListener('change', function() {
          const value = parseCurrency(this.value);
          if (!isNaN(value)) { slider.value = value; slider.dispatchEvent(new Event('input')); }
        });
      }
    });
    
    document.querySelectorAll('.data-row.has-slider').forEach(row => {
      row.addEventListener('mouseenter', function() { this.style.backgroundColor = 'rgba(5, 150, 105, 0.04)'; });
      row.addEventListener('mouseleave', function() { this.style.backgroundColor = ''; });
    });
    
    document.getElementById('property-type').addEventListener('change', function() {
      const units = this.value;
      document.getElementById('unit3-row').style.display = (units >= 3) ? 'grid' : 'none';
      document.getElementById('unit4-row').style.display = (units >= 4) ? 'grid' : 'none';
      document.getElementById('unit3-display-row').style.display = (units >= 3) ? 'flex' : 'none';
      document.getElementById('unit4-display-row').style.display = (units >= 4) ? 'flex' : 'none';
      recalculateAll();
    });
    
    function recalculateAll() {
      const purchasePrice = getSliderValue('Purchase Price', 425000);
      const downPaymentPct = getSliderValue('Down Payment', 5) / 100;
      const closingCosts = getSliderValue('Closing Costs', 8625);
      const interestRate = getSliderValue('Interest Rate', 7.25) / 100;
      const loanTerm = getSliderValue('Loan Term', 30);
      const pmiRate = getSliderValue('PMI Rate', 0.8) / 100;
      
      const unit2Rent = getSliderValue('Unit 2 Rent', 1800);
      const unit3Rent = getSliderValue('Unit 3 Rent', 1600);
      const unit4Rent = getSliderValue('Unit 4 Rent', 1500);
      const vacancyRate = getSliderValue('Vacancy Rate', 5) / 100;
      
      const propertyTaxes = getSliderValue('Property Taxes', 354);
      const insurance = getSliderValue('Insurance', 175);
      const maintenancePct = getSliderValue('Maintenance', 5) / 100;
      const capexPct = getSliderValue('CapEx Reserve', 5) / 100;
      const utilities = getSliderValue('Utilities', 150);
      
      const numUnits = parseInt(document.getElementById('property-type').value) || 2;
      
      const downPayment = purchasePrice * downPaymentPct;
      const loanAmount = purchasePrice - downPayment;
      const totalCashNeeded = downPayment + closingCosts;
      
      const monthlyPI = calculateMortgagePayment(loanAmount, interestRate, loanTerm);
      const monthlyPMI = (loanAmount * pmiRate) / 12;
      const totalMonthlyPayment = monthlyPI + monthlyPMI;
      
      let totalRent = unit2Rent;
      if (numUnits >= 3) totalRent += unit3Rent;
      if (numUnits >= 4) totalRent += unit4Rent;
      const effectiveRent = totalRent * (1 - vacancyRate);
      
      const maintenanceCost = totalRent * maintenancePct;
      const capexCost = totalRent * capexPct;
      const totalOpEx = propertyTaxes + insurance + maintenanceCost + capexCost + utilities;
      
      const housingCost = totalMonthlyPayment + totalOpEx - effectiveRent;
      const marketRentEquivalent = 2200;
      const savingsVsRenting = marketRentEquivalent - housingCost;
      
      let ownerUnitRent = unit2Rent;
      const fullRentalIncome = (totalRent + ownerUnitRent) * (1 - vacancyRate);
      const fullRentalOpEx = propertyTaxes + insurance + (fullRentalIncome * maintenancePct) + (fullRentalIncome * capexPct);
      const moveOutCashFlow = fullRentalIncome - totalMonthlyPayment - fullRentalOpEx;
      
      const annualNOI = (fullRentalIncome - fullRentalOpEx) * 12;
      const capRate = (annualNOI / purchasePrice) * 100;
      const cocReturn = ((moveOutCashFlow * 12) / totalCashNeeded) * 100;
      
      let dealScore = 50;
      if (savingsVsRenting > 500) dealScore += 20;
      else if (savingsVsRenting > 0) dealScore += 10;
      if (moveOutCashFlow > 300) dealScore += 15;
      if (cocReturn > 15) dealScore += 15;
      if (downPaymentPct <= 0.05) dealScore += 5;
      dealScore = Math.min(100, Math.max(0, Math.round(dealScore)));
      
      updateElement('summary-housing-cost', formatCurrency(housingCost));
      updateElement('summary-rental-income', formatCurrency(effectiveRent));
      updateElement('summary-cash-needed', formatCurrency(totalCashNeeded));
      updateElement('summary-move-out', formatCurrency(moveOutCashFlow) + '/mo');
      updateElement('summary-coc', cocReturn.toFixed(1) + '%');
      updateElement('summary-deal-score', dealScore);
      const scoreLabel = document.getElementById('score-label');
      if (scoreLabel) { if (dealScore >= 85) scoreLabel.textContent = 'Excellent'; else if (dealScore >= 70) scoreLabel.textContent = 'Great'; else if (dealScore >= 55) scoreLabel.textContent = 'Good'; else scoreLabel.textContent = 'Fair'; }
      
      updateElement('down-payment-amt', formatCurrency(downPayment));
      updateElement('calc-total-cash', formatCurrency(totalCashNeeded));
      updateElement('calc-loan-amount', formatCurrency(loanAmount));
      updateElement('calc-monthly-payment', formatCurrency(totalMonthlyPayment));
      updateElement('pmi-amt', formatCurrency(monthlyPMI) + '/mo');
      updateElement('calc-rental-income', formatCurrency(effectiveRent) + '/mo');
      updateElement('maintenance-amt', formatCurrency(maintenanceCost) + '/mo');
      updateElement('capex-amt', formatCurrency(capexCost) + '/mo');
      updateElement('calc-total-expenses', '-' + formatCurrency(totalOpEx) + '/mo');
      
      updateElement('cf-mortgage', formatCurrency(totalMonthlyPayment));
      updateElement('cf-opex', formatCurrency(totalOpEx));
      updateElement('cf-income', '-' + formatCurrency(effectiveRent));
      updateElement('cf-housing-cost', formatCurrency(housingCost));
      updateElement('cf-market-rent', formatCurrency(marketRentEquivalent));
      updateElement('cf-savings', (savingsVsRenting >= 0 ? '+' : '') + formatCurrency(savingsVsRenting));
      document.getElementById('cf-savings').style.color = savingsVsRenting >= 0 ? 'var(--ws-positive)' : 'var(--ws-negative)';
      document.getElementById('cf-housing-cost').style.color = housingCost <= marketRentEquivalent ? 'var(--hh-primary)' : 'var(--ws-negative)';
      
      updateElement('gauge-housing-cost', formatCurrency(housingCost));
      document.getElementById('gauge-housing-cost').style.color = housingCost <= marketRentEquivalent ? 'var(--hh-primary)' : 'var(--ws-negative)';
      updateElement('bar-househack', formatCurrency(housingCost));
      updateElement('bar-renting', formatCurrency(marketRentEquivalent));
      updateElement('gauge-savings', formatCurrency(savingsVsRenting) + '/mo');
      const barFill = document.getElementById('bar-househack-fill');
      if (barFill) barFill.style.width = Math.max(5, (housingCost / marketRentEquivalent) * 100) + '%';
      
      updateElement('unit2-display', formatCurrency(unit2Rent) + '/mo');
      updateElement('unit3-display', formatCurrency(unit3Rent) + '/mo');
      updateElement('unit4-display', formatCurrency(unit4Rent) + '/mo');
      
      updateElement('moveout-cashflow', formatCurrency(moveOutCashFlow));
      updateElement('moveout-cap', capRate.toFixed(1) + '%');
      updateElement('moveout-coc', cocReturn.toFixed(1) + '%');
      document.getElementById('moveout-cashflow').style.color = moveOutCashFlow >= 0 ? 'var(--ws-positive)' : 'var(--ws-negative)';
      
      const listPrice = purchasePrice * 1.056;
      const breakeven = purchasePrice + ((totalMonthlyPayment + totalOpEx - effectiveRent) * 12 / 0.08);
      const tenCoCPrice = purchasePrice * 0.93;
      const fhaMax = 472030;
      updateElement('ladder-list', formatCurrency(listPrice));
      updateElement('ladder-offer', formatCurrency(purchasePrice));
      const breakevenEl = document.getElementById('ladder-breakeven');
      if (breakevenEl) breakevenEl.innerHTML = formatCurrency(breakeven) + '<span class="pricing-ladder-hint">$0 housing cost</span>';
      const cocEl = document.getElementById('ladder-10coc');
      if (cocEl) cocEl.innerHTML = formatCurrency(tenCoCPrice) + '<span class="pricing-ladder-hint">After move-out</span>';
      const fhaEl = document.getElementById('ladder-fha');
      if (fhaEl) fhaEl.innerHTML = formatCurrency(fhaMax) + '<span class="pricing-ladder-hint">Your area</span>';
    }
    
    function getSliderValue(labelText, defaultValue) {
      const rows = document.querySelectorAll('.data-row.has-slider');
      for (const row of rows) {
        const label = row.querySelector('.data-label span')?.textContent || '';
        if (label.includes(labelText)) {
          const slider = row.querySelector('.slider-input');
          if (slider) return parseFloat(slider.value);
        }
      }
      return defaultValue;
    }
    
    function calculateMortgagePayment(principal, annualRate, years) {
      const monthlyRate = annualRate / 12;
      const numPayments = years * 12;
      if (monthlyRate === 0) return principal / numPayments;
      return principal * (monthlyRate * Math.pow(1 + monthlyRate, numPayments)) / (Math.pow(1 + monthlyRate, numPayments) - 1);
    }
    
    // ===== LOAD PROPERTY DATA FROM LOCALSTORAGE =====
    function loadPropertyData() {
      try {
        const storedData = localStorage.getItem('worksheetProperty');
        if (!storedData) return;
        
        const property = JSON.parse(storedData);
        console.log('[House Hack Worksheet] Loaded property:', property);
        
        const titleEl = document.getElementById('property-title');
        const subtitleEl = document.getElementById('property-subtitle');
        const priceEl = document.getElementById('property-price-badge');
        
        if (titleEl && property.address) titleEl.textContent = property.address;
        
        if (subtitleEl) {
          const location = `${property.city || ''}, ${property.state || ''} ${property.zipCode || ''}`;
          const specs = `${property.bedrooms || 0} BR • ${property.bathrooms || 0} BA • ${(property.sqft || 0).toLocaleString()} Sq.Ft.`;
          subtitleEl.textContent = `${location} • ${specs}`;
        }
        
        if (priceEl && property.listPrice) priceEl.textContent = formatCurrency(property.listPrice);
        
        updateSliderByLabel('Purchase Price', property.listPrice);
        if (property.monthlyRent) updateSliderByLabel('Unit 2 Rent', property.monthlyRent);
        
      } catch (error) {
        console.error('[House Hack Worksheet] Error loading property data:', error);
      }
    }
    
    function updateSliderByLabel(labelText, value) {
      if (!value) return;
      const rows = document.querySelectorAll('.data-row.has-slider');
      for (const row of rows) {
        const label = row.querySelector('.data-label span')?.textContent || '';
        if (label.includes(labelText)) {
          const slider = row.querySelector('.slider-input');
          const input = row.querySelector('.slider-value');
          if (slider) {
            slider.value = value;
            const min = parseFloat(slider.min), max = parseFloat(slider.max);
            const progress = ((value - min) / (max - min)) * 100;
            slider.style.background = `linear-gradient(to right, #059669 0%, #059669 ${progress}%, #e2e8f0 ${progress}%, #e2e8f0 100%)`;
          }
          if (input) input.value = formatCurrency(value);
          break;
        }
      }
    }
    
    loadPropertyData();
    recalculateAll();
    
    (function() {
      const dropdown = document.getElementById('strategy-dropdown');
      const trigger = document.querySelector('.strategy-dropdown-trigger');
      if (trigger) { trigger.addEventListener('click', function(event) { event.stopPropagation(); dropdown.classList.toggle('open'); }); }
      document.addEventListener('click', function(event) { if (dropdown && !dropdown.contains(event.target)) { dropdown.classList.remove('open'); } });
    })();
    
    window.selectStrategy = function(strategy, name, url) {
      document.getElementById('current-strategy-name').textContent = name;
      document.querySelectorAll('.strategy-option').forEach(opt => { opt.classList.remove('active'); });
      const activeOption = document.querySelector(`[data-strategy="${strategy}"]`);
      if (activeOption) activeOption.classList.add('active');
      document.getElementById('strategy-dropdown').classList.remove('open');
      if (url && url !== '#' && !window.location.href.includes(url)) { window.location.href = url; }
    }
  </script>
</body>
</html>

